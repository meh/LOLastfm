lololololololol last.fm

Supported players:
MOC        - Full support.
MPD        - Full support, might hang if the connection with the server dies.
mp3blaster - Nearly full support. Doesn't support song repeating submits, it's a problem of mp3blaster.
Rhythmbox  - Full support.
Amarok     - Full support.
Others     - Have the same problem of mp3blaster, see below for more informations.

For others I mean just put the binary name of the player and see if it works, it probably will :)

Tested (and working) others:
mplayer    - Works like a charm.
totem      - If you listen to one song you have to play another one or quit totem to scrobble, it's a totem's bug.
vlc        - Works like a charm.
alsaplayer - Works like a charm.

Features:
Player independant, supported players are listed below.
Supports the "Listening Now" last.fm function.
Supports caching of listenings when there are connection/server problems and sends them when possible.
Submits multiple times when listening repeatedly to the same song.

Services:
To use services you need a supporting threads Perl, IO::Socket and JSON to be installed.

current - get current song informations.
submit  - send a song to last.fm with a given account or the configuration one.
change  - event-like on song change, uses blocking sockets to wait till the song changes and gives infos about it.

Installation:
--
# perl -MCPAN -e shell
cpan> install Net::LastFM::Submission
cpan> install XML::Simple
--

And then you can *make install* it (as root) :)

LOLastfm -h for the options or use the /etc/init.d/LOLastfm (only for Gentoo and runscript compliant distros), or the general daemon in etc/rc.d/ :)

MPD dependencies:
- Audio::MPD

Amarok dependencies:
- DCOP::Amarok::Player

Other dependencies (it also needs the program lsof):
- Music::Tag
- Music::Tag::MP3
- Music::Tag::OGG
- Music::Tag::M4A
- Music::Tag::FLAC
